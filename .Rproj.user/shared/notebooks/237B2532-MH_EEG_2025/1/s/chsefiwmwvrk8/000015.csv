"0",""
"0","# Compute proportions within each visit"
"0","plot_data <- MH_stratification %>%"
"0","  group_by(Visit, GAD7_category) %>%"
"0","  summarise(n = n(), .groups = ""drop"") %>%"
"0","  group_by(Visit) %>%"
"0","  mutate(percent = n / sum(n))  # Calculate percent per visit"
"0",""
"0","# Plot"
"0","ggplot(plot_data, aes(x = Visit, y = percent, fill = GAD7_category)) +"
"0","  geom_bar(stat = ""identity"", position = ""fill"", alpha = 0.8) +  "
"0","  geom_text(aes(label = scales::percent(percent, accuracy = 1)), "
"0","            position = position_fill(vjust = 0.5), "
"0","            size = 3, color = ""black"") +  # Adjust text size & color"
"0","  labs(x = ""Gestational Weeks"", y = ""Proportion"", fill = ""GAD-7 Category"") +"
"0","  theme_classic() +"
"0","  scale_fill_manual(values = c(""Normal"" = ""dodgerblue2"", ""Mild"" = ""mediumpurple"", "
"0","                               ""Moderate/Severe"" = ""darkorange2"", ""Missing"" = ""grey"")) +"
"0","  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +  # Format y-axis as percentage"
"0","  theme(axis.text.x = element_text(size = 14, color = ""black""),"
"0","        axis.text.y = element_text(size = 14, color = ""black""),"
"0","        axis.title.x = element_text(size = 16, color = ""black""),"
"0","        axis.title.y = element_text(size = 16, color = ""black""),"
"0","        legend.title = element_text(size = 14),"
"0","        legend.text = element_text(size = 12))  +"
"0","  scale_x_discrete(limits = c(""<16"", ""20"",""24-28"", ""36"", ""Postpartum""))  "
