"0","# Prep the Data"
"0","MH_stratification <- All_obs %>% dplyr::select(""Visit"", ""ParticipantID"", ""PHQ9"", ""GAD7"")"
"0",""
"0","# Add categories"
"0","MH_stratification <- MH_stratification %>% "
"0","  mutate(PHQ9_category = case_when("
"0","    PHQ9 <= 4 ~ ""Normal"","
"0","    PHQ9 >= 5 & PHQ9 <= 9 ~ ""Mild"","
"0","    PHQ9 >= 10 ~ ""Moderate/Severe"","
"0","    is.na(PHQ9) ~ ""Missing"")) %>% "
"0","  mutate(GAD7_category = case_when("
"0","    GAD7 <= 4 ~ ""Normal"","
"0","    GAD7 >= 5 & GAD7 <= 9 ~ ""Mild"","
"0","    GAD7 >= 10 ~ ""Moderate/Severe"","
"0","    is.na(GAD7) ~ ""Missing""))"
"0",""
"0","# PHQ-9"
"0","ggplot(MH_stratification, aes(x = Visit, fill = PHQ9_category)) +"
"0","  geom_bar(position = ""dodge"") +  "
"0","  labs(x = ""Visit"", y = ""Count"", fill = ""Category"") +"
"0","  theme_classic() +"
"0","  scale_fill_manual(values = c(""Normal"" = ""darkblue"", ""Mild"" = ""orange"", "
"0","                               ""Moderate/Severe"" = ""red4"", ""Missing"" = ""grey"")) +"
"0","  theme(axis.text.x = element_text(size = 14, color = ""black""),"
"0","        axis.text.y = element_text(size = 14, color = ""black""),"
"0","        axis.title.x = element_text(size = 16, color = ""black""),"
"0","        axis.title.y = element_text(size = 16, color = ""black""),"
"0","        legend.title = element_text(size = 14),"
"0","        legend.text = element_text(size = 12))  +"
"0","  scale_x_discrete(limits = c(""T1"", ""SV"",""T2"", ""T3"", ""PP"")) "
