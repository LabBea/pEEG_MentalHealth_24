"0","# 1. Reshape data to wide format so we can run a paired test"
"0","##########################################################"
"0","# Filter out NAs for plotting"
"0","All_obs_na <- All_obs %>% filter(!is.na(PHQ9))"
"0","data_wide <- dcast(All_obs_na, ParticipantID ~ Visit, value.var = ""PHQ9_c"")"
"2","Aggregation function missing: defaulting to length
"
"0","# 2. Loop over the visits to run the paired wilcox test"
"0","##########################################################"
"0",""
"0","# List of visits"
"0","visits <- colnames(data_wide)[-1]"
"0",""
"0","# Matrix to store the p values from the test"
"0","p_values <- matrix(NA, ncol = length(visits), nrow = length(visits), dimnames = list(visits, visits))"
"0",""
"0","# loop over all pairs of visits"
"0","for (i in 1:(length(visits) - 1)) {"
"0","  for (j in (i + 1):length(visits)) {"
"0","    visit1 <- visits[i]"
"0","    visit2 <- visits[j]"
"0","    "
"0","    # Perform Wilcoxon signed-rank test paired"
"0","    test <- wilcox.test(data_wide[[visit1]], data_wide[[visit2]], "
"0","                        paired = TRUE, "
"0","                        exact = FALSE)"
"0","    "
"0","    # Store p-value"
"0","    p_values[i, j] <- test$p.value"
"0","  }"
"0","}"
"0",""
"0","# Adjust p-values with Benjamini-Hochberg method"
"0","p_values_adjusted <- p.adjust(p_values, method = ""BH"")"
"0",""
"0","# store adjusted p-values into a matrix"
"0","wilcox_result <- matrix(p_values_adjusted, ncol = length(visits), nrow = length(visits), dimnames = list(visits, visits))"
"0",""
"0","# Print the findings from the wilcox test"
"0","wilcox_result"
"1","  "
"1"," PP"
"1","        SV"
"1","         T1"
"1","         T2"
"1","         T3"
"1","
PP"
"1"," NA"
"1"," 0.6304815"
"1"," 0.05907982"
"1"," 0.03264177"
"1"," 0.75930535"
"1","
SV"
"1"," NA"
"1","        NA"
"1"," 0.03264177"
"1"," 0.03264177"
"1"," 0.75930535"
"1","
T1"
"1"," NA"
"1","        NA"
"1","         NA"
"1"," 0.88344141"
"1"," 0.03264177"
"1","
T2"
"1"," NA"
"1","        NA"
"1","         NA"
"1","         NA"
"1"," 0.03264177"
"1","
T3"
"1"," NA"
"1","        NA"
"1","         NA"
"1","         NA"
"1","         NA"
"1","
"
